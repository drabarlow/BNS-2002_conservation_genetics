R
1+1
library(ape)
library(tidyverse)
library(slidify)
library(tidyverse)
library(gganimate)
library(RColorBrewer)
library(knitr)
library(ape)
include_graphics("./assets/img/smilodon1.png")
my.tree <- read.tree(text="((((human,chimp),(cat,dog)),(snake,lizard)),fish);")
par(mar=c(1,1,1,1))
plot(my.tree)
include_graphics("./assets/img/smilodon1.png")
library(tidyverse)
library(gganimate)
library(RColorBrewer)
library(knitr)
library(palmerpenguins)
mean_sd <- group_by(gen_chi, species) %>% summarize(mean_mass = mean(body_mass_g), sd = sd(body_mass_g))
?markdown
remove.packages(markdown)
remove.packages("markdown", lib="~/R/x86_64-pc-linux-gnu-library/4.2")
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
knitr::include_graphics("kudarensis.png")
library(tidyverse)
library(gganimate)
library(RColorBrewer)
library(knitr)
library(ape)
# assign colours to taxa - taken from RColorBrewer "paired"
ing=c("#E31A1C")
spe=c("#1F78B4")
kan=c("#FB9A99")
ere=c("#33A02C")
lad=c("#B2DF8A")
ros=c("#6A3D9A")
ros2=c("#CAB2D6")
kud=c("#FF7F00")
pra=c("#FDBF6F")
mar=c("#A6CEE3")
arc=c("#B15928")
# set up taxcol variable
taxcol=c(pra,kan,ros,ing,kud,spe,ere)
# calculate PCA
t <- read.table("./assets/data/no_HV72_for_PCA_bamlist.covMat")
e <- eigen(t)
# plot pdf: PCs 1 and 2
pdf("cave_PCA_1_2.pdf", width=7.2, height=5.8)
par(mar=c(5,5,4,10), xpd=T)
plot(e$vectors[,1:2],
xlim=c(-0.4,0.6), ylim=c(-0.5,1),
pch=21, bg=taxcol, cex=1.8,
main="PCA of 487,747 filtered transversion sites",
xlab="PC1: 44.3% of variation", ylab="PC2: 16.5% of variation", cex.lab=1.2
)
# assign colours to taxa - taken from RColorBrewer "paired"
ing=c("#E31A1C")
spe=c("#1F78B4")
kan=c("#FB9A99")
ere=c("#33A02C")
lad=c("#B2DF8A")
ros=c("#6A3D9A")
ros2=c("#CAB2D6")
kud=c("#FF7F00")
pra=c("#FDBF6F")
mar=c("#A6CEE3")
arc=c("#B15928")
# set up taxcol variable
taxcol=c(pra,kan,ros,ing,kud,spe,ere)
# calculate PCA
t <- read.table("./assets/data/no_HV72_for_PCA_bamlist.covMat")
e <- eigen(t)
# plot pdf: PCs 1 and 2
par(mar=c(5,5,4,10), xpd=T)
plot(e$vectors[,1:2],
xlim=c(-0.4,0.6), ylim=c(-0.5,1),
pch=21, bg=taxcol, cex=1.8,
main="PCA of 487,747 filtered transversion sites",
xlab="PC1: 44.3% of variation", ylab="PC2: 16.5% of variation", cex.lab=1.2
)
dev.off()
# assign colours to taxa - taken from RColorBrewer "paired"
ing=c("#E31A1C")
spe=c("#1F78B4")
kan=c("#FB9A99")
ere=c("#33A02C")
lad=c("#B2DF8A")
ros=c("#6A3D9A")
ros2=c("#CAB2D6")
kud=c("#FF7F00")
pra=c("#FDBF6F")
mar=c("#A6CEE3")
arc=c("#B15928")
# calculate PCA
t <- read.table("./assets/data/no_HV72_for_PCA_bamlist.covMat")
e <- eigen(t)
# plot PCs 1 and 2
par(mar=c(5,5,4,10), xpd=T)
plot(e$vectors[,1:2],
xlim=c(-0.4,0.6), ylim=c(-0.5,1),
pch=21, bg=taxcol, cex=1.8,
main="PCA of 487,747 filtered transversion sites",
xlab="PC1: 44.3% of variation", ylab="PC2: 16.5% of variation", cex.lab=1.2
)
# assign colours to taxa - taken from RColorBrewer "paired"
ing=c("#E31A1C")
spe=c("#1F78B4")
kan=c("#FB9A99")
ere=c("#33A02C")
lad=c("#B2DF8A")
ros=c("#6A3D9A")
ros2=c("#CAB2D6")
kud=c("#FF7F00")
pra=c("#FDBF6F")
mar=c("#A6CEE3")
arc=c("#B15928")
# calculate PCA
t <- read.table("./assets/data/no_HV72_for_PCA_bamlist.covMat")
e <- eigen(t)
# plot PCs 1 and 2
par(mar=c(5,5,4,10), xpd=T)
my_plot <- plot(e$vectors[,1:2],
xlim=c(-0.4,0.6), ylim=c(-0.5,1),
pch=21, bg=taxcol, cex=1.8,
main="PCA of 487,747 filtered transversion sites",
xlab="PC1: 44.3% of variation", ylab="PC2: 16.5% of variation", cex.lab=1.2
)
my_plot
library(slidify)
setwd("~/Documents/teaching/BNS-2002_evol_gen/2022-2023")
author("BNS-2002_Barlow_lecture4")
